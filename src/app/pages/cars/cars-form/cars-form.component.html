<ion-header translucent>
  <ion-toolbar color="primary">
    <ion-title>Registrar Carro</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen class="ion-padding">
  <form [formGroup]="carsForm" (submit)="onSubmit()">
    <ion-list inset>
      <ion-item>
        <ion-label position="floating">Marca</ion-label>
        <ion-input
          type="text"
          formControlName="brand"
          placeholder="Ej: Honda"
        ></ion-input>
      </ion-item>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.brand.errors?.required"
      >
        Especifica la marca del carro.
      </ion-text>

      <ion-item>
        <ion-label position="floating">Línea</ion-label>
        <ion-input
          type="text"
          formControlName="line"
          placeholder="Ej: Civic"
        ></ion-input>
      </ion-item>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.line.errors?.required"
      >
        Especifica la línea del carro.
      </ion-text>

      <ion-item>
        <ion-label position="floating">Modelo</ion-label>
        <ion-input
          type="text"
          formControlName="model"
          placeholder="Ej: 2015"
        ></ion-input>
      </ion-item>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.model.errors?.required"
      >
        Especifica el modelo del carro.
      </ion-text>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.model.errors?.pattern"
      >
        El modelo no es válido.
      </ion-text>

      <ion-item>
        <ion-label>Tipo de Transmisión</ion-label>
        <ion-select
          [value]="this.update ? this.car.transmition : 'Automatica'"
          (ionChange)="changeValue(s.value)"
          #s
        >
          <ion-select-option value="Automatica">Automática</ion-select-option>
          <ion-select-option value="Mecanica">Mecánica</ion-select-option>
        </ion-select>

        <ion-input type="hidden" formControlName="transmition"></ion-input>
      </ion-item>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.transmition.errors?.required"
      >
        Especifica un tipo de Transmisión.
      </ion-text>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.transmition.errors?.pattern"
      >
        Transmisión inválida.
      </ion-text>

      <ion-item>
        <ion-label position="floating">Color</ion-label>
        <ion-input type="text" formControlName="color"></ion-input>
      </ion-item>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.color.errors?.required"
      >
        Especifica el color del carro.
      </ion-text>

      <ion-item>
        <ion-label position="floating">Placas</ion-label>
        <ion-input type="text" formControlName="license"></ion-input>
      </ion-item>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.license.errors?.required"
      >
        Registra las placas del vehículo.
      </ion-text>

      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.license.errors?.pattern"
      >
        Placas inválidas.
      </ion-text>

      <ion-grid>
        <ion-row>
          <ion-col>
            <ion-label position="floating">Fotos</ion-label>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col></ion-col>
          <ion-col>
            <ion-button
              color="tertiary"
              type="button"
              [disabled]="photo"
              (click)="takePicture('camera')"
            >
              <ion-icon slot="start" name="camera-outline"></ion-icon>
              Camara
            </ion-button>
          </ion-col>
          <ion-col>
            <ion-button
              color="medium"
              type="button"
              [disabled]="photo"
              (click)="takePicture('gallery')"
            >
              <ion-icon slot="start" name="folder-outline"></ion-icon>
              Galeria
            </ion-button>
          </ion-col>

          <ion-col></ion-col>
        </ion-row>
        <ion-row *ngIf="photo">
          <ion-col class="ion-align-items-center">
            <img [src]="photo" />
          </ion-col>
        </ion-row>
        <ion-row [hidden]="!photo">
          <ion-col>
            <ion-button
              type="button"
              (click)="photo = null"
              color="danger"
              class="ion-float-right ion-margin-right"
              size="small"
            >
              <ion-icon slot="start" name="trash-outline"></ion-icon>
              Quitar foto
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-grid>

      <input
        type="file"
        accept="image/*"
        *ngIf="isDesktop"
        #filePicker
        (change)="onFileChoose($event)"
      />
      <ion-text
        color="danger"
        *ngIf="isSubmitted && errorControl.license.errors?.required"
      >
        La foto no es válida.
      </ion-text>
    </ion-list>

    <ion-button type="submit" class="ion-margin" expand="full">
      {{ this.update ? "Actualizar" : "Crear" }}
    </ion-button>
  </form>
</ion-content>
